# =============================================================================
# Voter API - Environment Configuration
# =============================================================================
# Copy this file to .env and fill in the values.
# All configuration follows 12-factor app principles.

# --- Required ---

# PostgreSQL+PostGIS connection string (asyncpg driver)
DATABASE_URL=postgresql+asyncpg://voter_api:voter_api_dev@localhost:5432/voter_api
# DATABASE_SCHEMA=  # PostgreSQL schema for isolated environments (e.g., pr_42).
#                    # Used by PR previews. Leave unset for production.
#                    # Must match: ^[a-z_][a-z0-9_]{0,62}$

# JWT authentication
JWT_SECRET_KEY=changeme-generate-with-openssl-rand-hex-32-minimum-32-chars
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# --- Optional ---

# Geocoding — General
GEOCODER_DEFAULT_PROVIDER=census
GEOCODER_BATCH_SIZE=100
GEOCODER_RATE_LIMIT_PER_SECOND=10
GEOCODER_FALLBACK_ORDER=census,nominatim,geocodio,mapbox,google,photon

# Geocoding — Nominatim (OpenStreetMap, free, 1 req/sec)
GEOCODER_NOMINATIM_ENABLED=true
GEOCODER_NOMINATIM_EMAIL=
GEOCODER_NOMINATIM_TIMEOUT=10.0

# Geocoding — Google Maps (requires API key)
GEOCODER_GOOGLE_ENABLED=false
GEOCODER_GOOGLE_API_KEY=
GEOCODER_GOOGLE_TIMEOUT=10.0

# Geocoding — Geocodio (requires API key, supports batch)
GEOCODER_GEOCODIO_ENABLED=false
GEOCODER_GEOCODIO_API_KEY=
GEOCODER_GEOCODIO_BATCH_SIZE=1000
GEOCODER_GEOCODIO_TIMEOUT=30.0

# Geocoding — Mapbox (requires API key, supports batch)
GEOCODER_MAPBOX_ENABLED=false
GEOCODER_MAPBOX_API_KEY=
GEOCODER_MAPBOX_TIMEOUT=10.0
GEOCODER_MAPBOX_BATCH_SIZE=100

# Geocoding — Photon (Komoot, free, self-hostable)
GEOCODER_PHOTON_ENABLED=true
GEOCODER_PHOTON_BASE_URL=https://photon.komoot.io
GEOCODER_PHOTON_TIMEOUT=10.0

# Import
IMPORT_BATCH_SIZE=1000

# Export
EXPORT_DIR=./exports

# Meeting Records
MEETING_MAX_FILE_SIZE_MB=50
MEETING_UPLOAD_DIR=./uploads/meetings

# Election Tracking
ELECTION_REFRESH_ENABLED=true
ELECTION_REFRESH_INTERVAL=60

# Elected Officials Providers
OPEN_STATES_API_KEY=your-open-states-api-key
CONGRESS_GOV_API_KEY=your-congress-gov-api-key

# Data Seeding
DATA_ROOT_URL=https://data.hatchtech.dev/

# Logging
LOG_LEVEL=INFO
# LOG_DIR=logs  # Uncomment to enable file logging with 24h rotation

# CORS
CORS_ORIGINS=http://localhost:3000

# API
API_V1_PREFIX=/api/v1
RATE_LIMIT_PER_MINUTE=200
TRUSTED_PROXY_HEADERS=CF-Connecting-IP,X-Forwarded-For,X-Real-IP

# R2 / S3-Compatible Object Storage
# Set R2_ENABLED=true to enable publishing and redirect to static files
R2_ENABLED=false
# Cloudflare account ID (found in the R2 dashboard)
R2_ACCOUNT_ID=your-cloudflare-account-id
# R2 API token credentials
R2_ACCESS_KEY_ID=your-r2-access-key
R2_SECRET_ACCESS_KEY=your-r2-secret-key
# R2 bucket name
R2_BUCKET=your-bucket-name
# Public URL prefix (custom domain or https://pub-xxx.r2.dev)
R2_PUBLIC_URL=https://geo.yourdomain.com
# Key prefix within the bucket (default: empty, files at bucket root)
R2_PREFIX=
# Manifest cache TTL in seconds (default: 300 = 5 minutes)
R2_MANIFEST_TTL=300

